syntax = "proto3";
package playlist;

option go_package = "wavelength/server/proto/playlist;playlistpb";

import "google/protobuf/empty.proto";
import "proto/common.proto";

service PlaylistService {
  rpc GetPublicPlaylists(GetPublicPlaylistsRequest) returns (GetPublicPlaylistsResponse);
  rpc GetPlaylistTracksLength(PlaylistTracksLengthRequest) returns (PlaylistTracksLengthResponse);
  rpc AddRemovePlaylistTrack(AddRemovePlaylistTrackRequest) returns (AddRemovePlaylistTrackResponse);
  rpc ChangePlaylistVisibility(ChangePlaylistVisibilityRequest) returns (google.protobuf.Empty);
  rpc RearrangePlaylistTracks(RearrangePlaylistTracksRequest) returns (google.protobuf.Empty);
  rpc DeletePlaylist(DeletePlaylistRequest) returns (google.protobuf.Empty);
  rpc GetPlaylistTracks(GetPlaylistTracksRequest) returns (GetPlaylistTracksResponse);
  rpc GetUserPlaylists(GetUserPlaylistsRequest) returns (GetUserPlaylistsResponse);
  rpc GetPlaylistById(GetPlaylistByIdRequest) returns (GetPlaylistByIdResponse);
  rpc EditPlaylist(EditPlaylistRequest) returns (google.protobuf.Empty); 
  rpc CreatePlaylist(CreatePlaylistRequest) returns (google.protobuf.Empty);
}

// Request/Response messages
message EditPlaylistRequest {
  string playlist_id = 1;
  string name = 2;
  string cover_image = 3;
}

message CreatePlaylistRequest {
  string author_email = 1;
  string author_display_name = 2;
  string author_photo_url = 3;
}

message GetUserPlaylistsRequest {
  string user_email = 1;
}

message GetUserPlaylistsResponse {
  repeated common.Playlist playlists = 1;
}

message GetPlaylistByIdRequest {
  string playlist_id = 1;
}

message GetPlaylistByIdResponse {
  common.Playlist playlist = 1;
}

message AddRemovePlaylistTrackRequest {
  repeated common.EmbeddedArtist artists = 1;
  string thumbnail = 2;
  string duration = 3;
  bool is_explicit = 4;
  string title = 5;
  string video_id = 6;
  common.VideoType video_type = 7;
  string playlist_id = 8;
  optional common.EmbeddedAlbum album = 9;
}

message AddRemovePlaylistTrackResponse {
  enum PlaylistTrackToggleType {
    PLAYLIST_TRACK_TOGGLE_TYPE_UNSPECIFIED = 0;
    PLAYLIST_TRACK_TOGGLE_TYPE_REMOVE = 1;
    PLAYLIST_TRACK_TOGGLE_TYPE_ADD = 2;
  }
  PlaylistTrackToggleType toggle_type = 1;
}

message RearrangePlaylistTracksRequest {
  message PlaylistTrackPosUpdate {
    string playlist_track_id = 1;
    uint32 new_pos = 2;
  }
  string playlist_id = 1;
  repeated PlaylistTrackPosUpdate updates = 2;
}

message GetPlaylistTracksRequest {
  string playlist_id = 1;
}

message GetPlaylistTracksResponse {
  repeated common.PlaylistTrack playlist_tracks = 1;
}

message DeletePlaylistRequest {
  string playlist_id = 1;
  string auth_user_email = 2;
}

message ChangePlaylistVisibilityRequest {
  string playlist_id = 1;
  string auth_user_email = 2;
}

message PlaylistTracksLengthRequest {
  string playlist_id = 1;
}

message PlaylistTracksLengthResponse {
  common.TracksLength playlist_tracks_length = 1;
}

message GetPublicPlaylistsRequest {
  string query = 1;
}

message GetPublicPlaylistsResponse {
  repeated common.Playlist playlists = 1;
}
